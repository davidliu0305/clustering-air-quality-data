import urllib.parse
import requests
from params import API_KEY_WEATHERBIT,BASE_URI_WEATHERBIT

#DATA=[{'aqi': 34, 'pm10': 10.34, 'pm25': 6.56, 'o3': 72.78, 'timestamp_local': '2022-03-26T00:00:00', 'so2': 0.12, 'no2': 0.14, 'timestamp_utc': '2022-03-25T18:00:00', 'datetime': '2022-03-25:18', 'co': 157.01, 'ts': 1648231200}, {'aqi': 34, 'pm10': 10.18, 'pm25': 6.41, 'o3': 74.37, 'timestamp_local': '2022-03-25T23:00:00', 'so2': 0.14, 'no2': 0.12, 'timestamp_utc': '2022-03-25T17:00:00', 'datetime': '2022-03-25:17', 'co': 155.33, 'ts': 1648227600}, {'aqi': 35, 'pm10': 10.03, 'pm25': 6.26, 'o3': 75.97, 'timestamp_local': '2022-03-25T22:00:00', 'so2': 0.16, 'no2': 0.1, 'timestamp_utc': '2022-03-25T16:00:00', 'datetime': '2022-03-25:16', 'co': 153.65, 'ts': 1648224000}, {'aqi': 36, 'pm10': 9.87, 'pm25': 6.1, 'o3': 77.57, 'timestamp_local': '2022-03-25T21:00:00', 'so2': 0.18, 'no2': 0.08, 'timestamp_utc': '2022-03-25T15:00:00', 'datetime': '2022-03-25:15', 'co': 151.98, 'ts': 1648220400}, {'aqi': 37, 'pm10': 9.33, 'pm25': 5.72, 'o3': 79.14, 'timestamp_local': '2022-03-25T20:00:00', 'so2': 0.17, 'no2': 0.06, 'timestamp_utc': '2022-03-25T14:00:00', 'datetime': '2022-03-25:14', 'co': 148.21, 'ts': 1648216800}, {'aqi': 37, 'pm10': 8.79, 'pm25': 5.33, 'o3': 80.72, 'timestamp_local': '2022-03-25T19:00:00', 'so2': 0.16, 'no2': 0.04, 'timestamp_utc': '2022-03-25T13:00:00', 'datetime': '2022-03-25:13', 'co': 144.43, 'ts': 1648213200}, {'aqi': 38, 'pm10': 8.25, 'pm25': 4.95, 'o3': 82.29, 'timestamp_local': '2022-03-25T18:00:00', 'so2': 0.15, 'no2': 0.02, 'timestamp_utc': '2022-03-25T12:00:00', 'datetime': '2022-03-25:12', 'co': 140.66, 'ts': 1648209600}, {'aqi': 37, 'pm10': 9.4, 'pm25': 5.57, 'o3': 80.55, 'timestamp_local': '2022-03-25T17:00:00', 'so2': 0.15, 'no2': 0.02, 'timestamp_utc': '2022-03-25T11:00:00', 'datetime': '2022-03-25:11', 'co': 141.77, 'ts': 1648206000}, {'aqi': 36, 'pm10': 10.55, 'pm25': 6.19, 'o3': 78.81, 'timestamp_local': '2022-03-25T16:00:00', 'so2': 0.15, 'no2': 0.01, 'timestamp_utc': '2022-03-25T10:00:00', 'datetime': '2022-03-25:10', 'co': 142.87, 'ts': 1648202400}, {'aqi': 36, 'pm10': 11.7, 'pm25': 6.81, 'o3': 77.08, 'timestamp_local': '2022-03-25T15:00:00', 'so2': 0.15, 'no2': 0.01, 'timestamp_utc': '2022-03-25T09:00:00', 'datetime': '2022-03-25:09', 'co': 143.98, 'ts': 1648198800}, {'aqi': 36, 'pm10': 12.55, 'pm25': 7.37, 'o3': 77.73, 'timestamp_local': '2022-03-25T14:00:00', 'so2': 0.16, 'no2': 0.02, 'timestamp_utc': '2022-03-25T08:00:00', 'datetime': '2022-03-25:08', 'co': 149, 'ts': 1648195200}, {'aqi': 36, 'pm10': 13.4, 'pm25': 7.92, 'o3': 78.38, 'timestamp_local': '2022-03-25T13:00:00', 'so2': 0.16, 'no2': 0.02, 'timestamp_utc': '2022-03-25T07:00:00', 'datetime': '2022-03-25:07', 'co': 154.02, 'ts': 1648191600}, {'aqi': 37, 'pm10': 14.25, 'pm25': 8.48, 'o3': 79.03, 'timestamp_local': '2022-03-25T12:00:00', 'so2': 0.17, 'no2': 0.03, 'timestamp_utc': '2022-03-25T06:00:00', 'datetime': '2022-03-25:06', 'co': 159.05, 'ts': 1648188000}, {'aqi': 36, 'pm10': 13.8, 'pm25': 8.16, 'o3': 78.33, 'timestamp_local': '2022-03-25T11:00:00', 'so2': 0.17, 'no2': 0.04, 'timestamp_utc': '2022-03-25T05:00:00', 'datetime': '2022-03-25:05', 'co': 160.77, 'ts': 1648184400}, {'aqi': 36, 'pm10': 13.35, 'pm25': 7.83, 'o3': 77.64, 'timestamp_local': '2022-03-25T10:00:00', 'so2': 0.17, 'no2': 0.06, 'timestamp_utc': '2022-03-25T04:00:00', 'datetime': '2022-03-25:04', 'co': 162.49, 'ts': 1648180800}, {'aqi': 36, 'pm10': 12.91, 'pm25': 7.51, 'o3': 76.94, 'timestamp_local': '2022-03-25T09:00:00', 'so2': 0.17, 'no2': 0.08, 'timestamp_utc': '2022-03-25T03:00:00', 'datetime': '2022-03-25:03', 'co': 164.22, 'ts': 1648177200}, {'aqi': 35, 'pm10': 12.52, 'pm25': 7.28, 'o3': 76.53, 'timestamp_local': '2022-03-25T08:00:00', 'so2': 0.16, 'no2': 0.1, 'timestamp_utc': '2022-03-25T02:00:00', 'datetime': '2022-03-25:02', 'co': 164.32, 'ts': 1648173600}, {'aqi': 35, 'pm10': 12.13, 'pm25': 7.05, 'o3': 76.11, 'timestamp_local': '2022-03-25T07:00:00', 'so2': 0.15, 'no2': 0.11, 'timestamp_utc': '2022-03-25T01:00:00', 'datetime': '2022-03-25:01', 'co': 164.42, 'ts': 1648170000}, {'aqi': 35, 'pm10': 11.74, 'pm25': 6.81, 'o3': 75.69, 'timestamp_local': '2022-03-25T06:00:00', 'so2': 0.14, 'no2': 0.13, 'timestamp_utc': '2022-03-25T00:00:00', 'datetime': '2022-03-25:00', 'co': 164.52, 'ts': 1648166400}, {'aqi': 35, 'pm10': 12.08, 'pm25': 7.22, 'o3': 76.05, 'timestamp_local': '2022-03-25T05:00:00', 'so2': 0.14, 'no2': 0.12, 'timestamp_utc': '2022-03-24T23:00:00', 'datetime': '2022-03-24:23', 'co': 164.1, 'ts': 1648162800}, {'aqi': 35, 'pm10': 12.42, 'pm25': 7.62, 'o3': 76.42, 'timestamp_local': '2022-03-25T04:00:00', 'so2': 0.14, 'no2': 0.11, 'timestamp_utc': '2022-03-24T22:00:00', 'datetime': '2022-03-24:22', 'co': 163.68, 'ts': 1648159200}, {'aqi': 36, 'pm10': 12.76, 'pm25': 8.03, 'o3': 76.78, 'timestamp_local': '2022-03-25T03:00:00', 'so2': 0.14, 'no2': 0.1, 'timestamp_utc': '2022-03-24T21:00:00', 'datetime': '2022-03-24:21', 'co': 163.25, 'ts': 1648155600}, {'aqi': 36, 'pm10': 13.85, 'pm25': 8.61, 'o3': 77.04, 'timestamp_local': '2022-03-25T02:00:00', 'so2': 0.16, 'no2': 0.09, 'timestamp_utc': '2022-03-24T20:00:00', 'datetime': '2022-03-24:20', 'co': 162.35, 'ts': 1648152000}, {'aqi': 38, 'pm10': 14.95, 'pm25': 9.19, 'o3': 77.3, 'timestamp_local': '2022-03-25T01:00:00', 'so2': 0.19, 'no2': 0.08, 'timestamp_utc': '2022-03-24T19:00:00', 'datetime': '2022-03-24:19', 'co': 161.44, 'ts': 1648148400}, {'aqi': 41, 'pm10': 16.04, 'pm25': 9.77, 'o3': 77.56, 'timestamp_local': '2022-03-25T00:00:00', 'so2': 0.21, 'no2': 0.08, 'timestamp_utc': '2022-03-24T18:00:00', 'datetime': '2022-03-24:18', 'co': 160.54, 'ts': 1648144800}, {'aqi': 41, 'pm10': 16.27, 'pm25': 9.81, 'o3': 77.67, 'timestamp_local': '2022-03-24T23:00:00', 'so2': 0.23, 'no2': 0.07, 'timestamp_utc': '2022-03-24T17:00:00', 'datetime': '2022-03-24:17', 'co': 159.12, 'ts': 1648141200}, {'aqi': 41, 'pm10': 16.49, 'pm25': 9.85, 'o3': 77.79, 'timestamp_local': '2022-03-24T22:00:00', 'so2': 0.26, 'no2': 0.06, 'timestamp_utc': '2022-03-24T16:00:00', 'datetime': '2022-03-24:16', 'co': 157.7, 'ts': 1648137600}, {'aqi': 41, 'pm10': 16.71, 'pm25': 9.89, 'o3': 77.9, 'timestamp_local': '2022-03-24T21:00:00', 'so2': 0.28, 'no2': 0.05, 'timestamp_utc': '2022-03-24T15:00:00', 'datetime': '2022-03-24:15', 'co': 156.28, 'ts': 1648134000}, {'aqi': 39, 'pm10': 15.9, 'pm25': 9.48, 'o3': 78.44, 'timestamp_local': '2022-03-24T20:00:00', 'so2': 0.28, 'no2': 0.04, 'timestamp_utc': '2022-03-24T14:00:00', 'datetime': '2022-03-24:14', 'co': 153.67, 'ts': 1648130400}, {'aqi': 38, 'pm10': 15.08, 'pm25': 9.08, 'o3': 78.97, 'timestamp_local': '2022-03-24T19:00:00', 'so2': 0.28, 'no2': 0.03, 'timestamp_utc': '2022-03-24T13:00:00', 'datetime': '2022-03-24:13', 'co': 151.05, 'ts': 1648126800}, {'aqi': 37, 'pm10': 14.27, 'pm25': 8.68, 'o3': 79.5, 'timestamp_local': '2022-03-24T18:00:00', 'so2': 0.28, 'no2': 0.01, 'timestamp_utc': '2022-03-24T12:00:00', 'datetime': '2022-03-24:12', 'co': 148.43, 'ts': 1648123200}, {'aqi': 37, 'pm10': 14.71, 'pm25': 8.95, 'o3': 78.78, 'timestamp_local': '2022-03-24T17:00:00', 'so2': 0.29, 'no2': 0.01, 'timestamp_utc': '2022-03-24T11:00:00', 'datetime': '2022-03-24:11', 'co': 148.06, 'ts': 1648119600}, {'aqi': 38, 'pm10': 15.15, 'pm25': 9.23, 'o3': 78.05, 'timestamp_local': '2022-03-24T16:00:00', 'so2': 0.3, 'no2': 0.01, 'timestamp_utc': '2022-03-24T10:00:00', 'datetime': '2022-03-24:10', 'co': 147.68, 'ts': 1648116000}, {'aqi': 40, 'pm10': 15.59, 'pm25': 9.5, 'o3': 77.32, 'timestamp_local': '2022-03-24T15:00:00', 'so2': 0.31, 'no2': 0.01, 'timestamp_utc': '2022-03-24T09:00:00', 'datetime': '2022-03-24:09', 'co': 147.3, 'ts': 1648112400}, {'aqi': 37, 'pm10': 14.09, 'pm25': 8.89, 'o3': 75.21, 'timestamp_local': '2022-03-24T14:00:00', 'so2': 0.34, 'no2': 0.01, 'timestamp_utc': '2022-03-24T08:00:00', 'datetime': '2022-03-24:08', 'co': 150.83, 'ts': 1648108800}, {'aqi': 34, 'pm10': 12.59, 'pm25': 8.28, 'o3': 73.1, 'timestamp_local': '2022-03-24T13:00:00', 'so2': 0.36, 'no2': 0.01, 'timestamp_utc': '2022-03-24T07:00:00', 'datetime': '2022-03-24:07', 'co': 154.37, 'ts': 1648105200}, {'aqi': 33, 'pm10': 11.09, 'pm25': 7.66, 'o3': 70.99, 'timestamp_local': '2022-03-24T12:00:00', 'so2': 0.38, 'no2': 0.02, 'timestamp_utc': '2022-03-24T06:00:00', 'datetime': '2022-03-24:06', 'co': 157.9, 'ts': 1648101600}, {'aqi': 32, 'pm10': 10.52, 'pm25': 7.46, 'o3': 68.49, 'timestamp_local': '2022-03-24T11:00:00', 'so2': 0.32, 'no2': 0.04, 'timestamp_utc': '2022-03-24T05:00:00', 'datetime': '2022-03-24:05', 'co': 154.84, 'ts': 1648098000}, {'aqi': 31, 'pm10': 9.94, 'pm25': 7.26, 'o3': 66, 'timestamp_local': '2022-03-24T10:00:00', 'so2': 0.25, 'no2': 0.07, 'timestamp_utc': '2022-03-24T04:00:00', 'datetime': '2022-03-24:04', 'co': 151.78, 'ts': 1648094400}, {'aqi': 29, 'pm10': 9.36, 'pm25': 7.06, 'o3': 63.5, 'timestamp_local': '2022-03-24T09:00:00', 'so2': 0.19, 'no2': 0.1, 'timestamp_utc': '2022-03-24T03:00:00', 'datetime': '2022-03-24:03', 'co': 148.72, 'ts': 1648090800}, {'aqi': 30, 'pm10': 9.58, 'pm25': 7.13, 'o3': 63.06, 'timestamp_local': '2022-03-24T08:00:00', 'so2': 0.18, 'no2': 0.13, 'timestamp_utc': '2022-03-24T02:00:00', 'datetime': '2022-03-24:02', 'co': 147.7, 'ts': 1648087200}, {'aqi': 30, 'pm10': 9.8, 'pm25': 7.21, 'o3': 62.63, 'timestamp_local': '2022-03-24T07:00:00', 'so2': 0.16, 'no2': 0.16, 'timestamp_utc': '2022-03-24T01:00:00', 'datetime': '2022-03-24:01', 'co': 146.68, 'ts': 1648083600}, {'aqi': 30, 'pm10': 10.02, 'pm25': 7.28, 'o3': 62.19, 'timestamp_local': '2022-03-24T06:00:00', 'so2': 0.14, 'no2': 0.19, 'timestamp_utc': '2022-03-24T00:00:00', 'datetime': '2022-03-24:00', 'co': 145.66, 'ts': 1648080000}, {'aqi': 30, 'pm10': 9.97, 'pm25': 7.17, 'o3': 62.5, 'timestamp_local': '2022-03-24T05:00:00', 'so2': 0.13, 'no2': 0.18, 'timestamp_utc': '2022-03-23T23:00:00', 'datetime': '2022-03-23:23', 'co': 144.31, 'ts': 1648076400}, {'aqi': 29, 'pm10': 9.92, 'pm25': 7.06, 'o3': 62.81, 'timestamp_local': '2022-03-24T04:00:00', 'so2': 0.12, 'no2': 0.17, 'timestamp_utc': '2022-03-23T22:00:00', 'datetime': '2022-03-23:22', 'co': 142.97, 'ts': 1648072800}, {'aqi': 29, 'pm10': 9.87, 'pm25': 6.95, 'o3': 63.11, 'timestamp_local': '2022-03-24T03:00:00', 'so2': 0.11, 'no2': 0.16, 'timestamp_utc': '2022-03-23T21:00:00', 'datetime': '2022-03-23:21', 'co': 141.63, 'ts': 1648069200}, {'aqi': 29, 'pm10': 10.05, 'pm25': 7.03, 'o3': 63.03, 'timestamp_local': '2022-03-24T02:00:00', 'so2': 0.1, 'no2': 0.15, 'timestamp_utc': '2022-03-23T20:00:00', 'datetime': '2022-03-23:20', 'co': 140.66, 'ts': 1648065600}, {'aqi': 30, 'pm10': 10.23, 'pm25': 7.11, 'o3': 62.95, 'timestamp_local': '2022-03-24T01:00:00', 'so2': 0.09, 'no2': 0.14, 'timestamp_utc': '2022-03-23T19:00:00', 'datetime': '2022-03-23:19', 'co': 139.68, 'ts': 1648062000}, {'aqi': 30, 'pm10': 10.41, 'pm25': 7.19, 'o3': 62.86, 'timestamp_local': '2022-03-24T00:00:00', 'so2': 0.08, 'no2': 0.13, 'timestamp_utc': '2022-03-23T18:00:00', 'datetime': '2022-03-23:18', 'co': 138.7, 'ts': 1648058400}]

#Get air quality data from API
def get_AQ_data(lat='35.5',lon='78.0',start_date='2022-03-24',end_date='2022-03-26'):
    url = urllib.parse.urljoin(BASE_URI_WEATHERBIT, f"/v2.0/history/airquality/")
    params = {'lat':lat,'lon':lon,'start_date':start_date,'end_date':end_date,'tz':'local','key':API_KEY_WEATHERBIT}
    results = requests.get(url, params=params).json()['data']
    return results